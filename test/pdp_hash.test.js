const { newPdp, FilePdpHashSt } = require("../pdp")
const { str2hexstr, hexstr2str } = require("ontology-ts-sdk").utils
describe('pdp hash test', () => {
    const pdpVersion = 1
    test('test pdp hash', async () => {
        const pdp = await newPdp(pdpVersion)
        let str = '3031303030303030303030303030303030303030303030303030303030303030303030303030' +
            '30303030303030303030303030303030303030303030303030303030303030303030303030303030303030' +
            '30303030303030303030303030303030303030303030303030303030303030303030303030303030303030' +
            '303030303030303030306534303130303030303030303030303030303030303030307b226e616d65223a22' +
            '4d7957616c6c6574222c2276657273696f6e223a22312e31222c22736372797074223a7b2270223a382c22' +
            '6e223a31363338342c2272223a382c22646b4c656e223a36347d2c226163636f756e7473223a5b7b226164' +
            '6472657373223a22414c5a584e38564b754e3633786173734155453239534731764b485466335775564622' +
            '2c22656e632d616c67223a226165732d3235362d67636d222c226b6579223a22334745676f48526575654f' +
            '6e513768496d357653307651712f74672f3237363036594d686d59725359323778355465666f515271536e' +
            '6a50777437385856724d222c22616c676f726974686d223a224543445341222c2273616c74223a224c6757' +
            '7258624a4f4c384e3944526a7a34726f646f673d3d222c22706172616d6574657273223a7b226375727665' +
            '223a22502d323536227d2c226c6162656c223a22707764222c227075626c69634b6579223a223033653535' +
            '63363233373565653637323561306137633435646234633230396161323861633038616139383564666336' +
            '333437353761386465383961326636616165222c227369676e6174757265536368656d65223a2253484132' +
            '3536776974684543445341222c22697344656661756c74223a747275652c226c6f636b223a66616c73657d5d7d'
        const hexResult = pdp.genUniqueIdWithFileBlocks([str])
        console.log('hex', hexResult)
        expect(hexResult).toEqual('01000000000000003d8e8df3996536b3f6a36cd559dd704f8372c82833ea8c71cca5e253a3dba1ce')
    });

    test('test file pdp serialize', () => {
        const st = new FilePdpHashSt(pdpVersion, ["19aedee05748b8af421f18388bc60c441813271207a960ea3b4a59007b159fa4"])
        const hex = st.serialize()
        console.log("hex", hex)
        expect(hex).toEqual("01000000000000000100000000000000200000000000000019aedee05748b8af421f18388bc60c441813271207a960ea3b4a59007b159fa4")
    });
})